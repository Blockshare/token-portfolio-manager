{"version":3,"sources":["../../../../src/lib/coordinates/EdgeIndicator.js"],"names":["React","Component","PropTypes","format","drawOnCanvas","renderSVG","GenericChartComponent","getAxisCanvas","first","last","isDefined","functor","EdgeIndicator","props","bind","ctx","moreProps","edge","helper","propTypes","yAccessor","func","type","oneOf","className","string","fill","oneOfType","textFill","itemType","isRequired","orient","edgeAt","displayFormat","rectHeight","number","rectWidth","arrowWidth","defaultProps","yAxisPad","fontFamily","fontSize","dx","hideLine","opacity","lineStroke","lineOpacity","plotData","item","getEdge","edgeType","xScale","yScale","chartConfig","xAccessor","yValue","xValue","x1","Math","round","y1","range","left","right","edgeX","coordinate","show","x2","y2"],"mappings":"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","file":"EdgeIndicator.js","sourcesContent":["\"use strict\";\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { format } from \"d3-format\";\n\nimport { drawOnCanvas, renderSVG } from \"./EdgeCoordinateV2\";\nimport GenericChartComponent from \"../GenericChartComponent\";\nimport { getAxisCanvas } from \"../GenericComponent\";\n\nimport { first, last, isDefined, functor } from \"../utils\";\n\nclass EdgeIndicator extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst edge = helper(this.props, moreProps);\n\t\tconst props = {\n\t\t\t...this.props,\n\t\t\t...edge,\n\t\t};\n\t\tdrawOnCanvas(ctx, props);\n\t}\n\trenderSVG(moreProps) {\n\t\tconst edge = helper(this.props, moreProps);\n\t\tconst props = {\n\t\t\t...this.props,\n\t\t\t...edge,\n\t\t};\n\t\treturn renderSVG(props);\n\t}\n\trender() {\n\t\treturn <GenericChartComponent\n\t\t\tedgeClip\n\t\t\tclip={false}\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getAxisCanvas}\n\t\t\tdrawOn={[\"pan\"]}\n\t\t/>;\n\t}\n}\n\nEdgeIndicator.propTypes = {\n\tyAccessor: PropTypes.func,\n\n\ttype: PropTypes.oneOf([\"horizontal\"]),\n\tclassName: PropTypes.string,\n\tfill: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.func,\n\t]),\n\ttextFill: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.func,\n\t]),\n\titemType: PropTypes.oneOf([\"first\", \"last\"]).isRequired,\n\torient: PropTypes.oneOf([\"left\", \"right\"]),\n\tedgeAt: PropTypes.oneOf([\"left\", \"right\"]),\n\tdisplayFormat: PropTypes.func,\n\trectHeight: PropTypes.number,\n\trectWidth: PropTypes.number,\n\tarrowWidth: PropTypes.number,\n};\n\nEdgeIndicator.defaultProps = {\n\tclassName: \"react-stockcharts-edgeindicator\",\n\n\ttype: \"horizontal\",\n\torient: \"left\",\n\tedgeAt: \"left\",\n\ttextFill: \"#FFFFFF\",\n\tdisplayFormat: format(\".2f\"),\n\tyAxisPad: 0,\n\trectHeight: 20,\n\trectWidth: 50,\n\tarrowWidth: 10,\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n\tfontSize: 13,\n\tdx: 0,\n\thideLine: false,\n\tfill: \"#8a8a8a\",\n\topacity: 1,\n\tlineStroke: \"#000000\",\n\tlineOpacity: 0.3,\n};\n\nfunction helper(props, moreProps) {\n\tconst { itemType, yAccessor } = props;\n\tconst { plotData } = moreProps;\n\n\tconst item = itemType === \"first\"\n\t\t? first(plotData, yAccessor)\n\t\t: last(plotData, yAccessor);\n\n\t// var currentItem = ChartDataUtil.getCurrentItemForChartNew(currentItems, forChart);\n\tconst edge = isDefined(item)\n\t\t? getEdge(props, moreProps, item)\n\t\t: null;\n\n\treturn edge;\n}\n\nfunction getEdge(props, moreProps, item) {\n\tconst { type: edgeType, displayFormat, edgeAt, yAxisPad, orient } = props;\n\n\tconst { yAccessor, fill, textFill, rectHeight, rectWidth, arrowWidth } = props;\n\tconst { fontFamily, fontSize } = props;\n\n\tconst { xScale, chartConfig: { yScale }, xAccessor } = moreProps;\n\n\tconst yValue = yAccessor(item),\n\t\txValue = xAccessor(item);\n\n\tconst x1 = Math.round(xScale(xValue)),\n\t\ty1 = Math.round(yScale(yValue));\n\n\tconst [left, right] = xScale.range();\n\tconst edgeX = edgeAt === \"left\"\n\t\t? left - yAxisPad\n\t\t: right + yAxisPad;\n\n\treturn {\n\t\t// ...props,\n\t\tcoordinate: displayFormat(yValue),\n\t\tshow: true,\n\t\ttype: edgeType,\n\t\torient,\n\t\tedgeAt: edgeX,\n\t\tfill: functor(fill)(item),\n\t\tfontFamily, fontSize,\n\t\ttextFill: functor(textFill)(item),\n\t\trectHeight, rectWidth, arrowWidth,\n\t\tx1,\n\t\ty1,\n\t\tx2: edgeX,\n\t\ty2: y1,\n\t};\n}\n\nexport default EdgeIndicator;\n"]}