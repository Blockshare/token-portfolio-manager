{"version":3,"sources":["../../../../../src/lib/interactive/hoc/EachText.js"],"names":["React","Component","PropTypes","noop","getCurrentItem","saveNodeType","isHover","HoverTextNearMouse","InteractiveText","EachText","props","handleHover","bind","handleDragStart","handleDrag","nodes","state","hover","moreProps","position","mouseXY","yScale","chartConfig","xScale","mouseX","mouseY","textCX","textCY","dx","dy","dragStartPosition","index","onDrag","xAccessor","currentItem","xValue","invert","xyValue","hovering","setState","bgFill","bgOpacity","textFill","fontFamily","fontSize","fontWeight","fontStyle","text","hoverText","selected","onDragComplete","hoverHandler","onHover","onUnHover","hoverTextEnabled","enable","restHoverTextProps","getNewXY","snapTo","plotData","x","y","propTypes","number","array","isRequired","string","bool","func","object","defaultProps","edgeStroke","edgeFill","edgeStrokeWidth","r","strokeWidth","opacity","fill","bgHeight","bgWidth"],"mappings":"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","file":"EachText.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { noop } from \"../../utils\";\nimport { getCurrentItem } from \"../../utils/ChartDataUtil\";\nimport { saveNodeType, isHover } from \"../utils\";\n\nimport HoverTextNearMouse from \"../components/HoverTextNearMouse\";\nimport InteractiveText from \"../components/InteractiveText\";\n\nclass EachText extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.handleHover = this.handleHover.bind(this);\n\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\n\t\tthis.handleDrag = this.handleDrag.bind(this);\n\n\t\tthis.isHover = isHover.bind(this);\n\t\tthis.saveNodeType = saveNodeType.bind(this);\n\t\tthis.nodes = {};\n\n\t\tthis.state = {\n\t\t\thover: false,\n\t\t};\n\t}\n\thandleDragStart(moreProps) {\n\t\tconst {\n\t\t\tposition,\n\t\t} = this.props;\n\t\tconst { mouseXY } = moreProps;\n\t\tconst { chartConfig: { yScale }, xScale } = moreProps;\n\t\tconst [mouseX, mouseY] = mouseXY;\n\n\t\tconst [textCX, textCY] = position;\n\t\tconst dx = mouseX - xScale(textCX);\n\t\tconst dy = mouseY - yScale(textCY);\n\n\t\tthis.dragStartPosition = {\n\t\t\tposition, dx, dy\n\t\t};\n\t}\n\thandleDrag(moreProps) {\n\t\tconst { index, onDrag } = this.props;\n\t\tconst {\n\t\t\tmouseXY: [, mouseY],\n\t\t\tchartConfig: { yScale },\n\t\t\txAccessor,\n\t\t\tcurrentItem,\n\t\t\txScale,\n\t\t} = moreProps;\n\n\t\tconst { dx, dy } = this.dragStartPosition;\n\t\tconst xValue = xScale.invert(xScale(xAccessor(currentItem)) - dx);\n\t\tconst xyValue = [\n\t\t\txValue,\n\t\t\tyScale.invert(mouseY - dy)\n\t\t];\n\n\t\tonDrag(index, xyValue);\n\t}\n\thandleHover(moreProps) {\n\t\tif (this.state.hover !== moreProps.hovering) {\n\t\t\tthis.setState({\n\t\t\t\thover: moreProps.hovering\n\t\t\t});\n\t\t}\n\t}\n\trender() {\n\t\tconst {\n\t\t\tposition,\n\t\t\tbgFill,\n\t\t\tbgOpacity,\n\t\t\ttextFill,\n\t\t\tfontFamily,\n\t\t\tfontSize,\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\ttext,\n\t\t\thoverText,\n\t\t\tselected,\n\t\t\tonDragComplete,\n\t\t} = this.props;\n\t\tconst { hover } = this.state;\n\n\t\tconst hoverHandler = {\n\t\t\tonHover: this.handleHover,\n\t\t\tonUnHover: this.handleHover\n\t\t};\n\n\t\tconst { enable: hoverTextEnabled, ...restHoverTextProps } = hoverText;\n\n\t\treturn <g>\n\t\t\t<InteractiveText\n\t\t\t\tref={this.saveNodeType(\"text\")}\n\t\t\t\tselected={selected || hover}\n\t\t\t\tinteractiveCursorClass=\"react-stockcharts-move-cursor\"\n\t\t\t\t{...hoverHandler}\n\n\t\t\t\tonDragStart={this.handleDragStart}\n\t\t\t\tonDrag={this.handleDrag}\n\t\t\t\tonDragComplete={onDragComplete}\n\n\t\t\t\tposition={position}\n\t\t\t\tbgFill={bgFill}\n\t\t\t\tbgOpacity={(hover || selected) ? bgOpacity : 0.1}\n\t\t\t\ttextFill={textFill}\n\t\t\t\tfontFamily={fontFamily}\n\t\t\t\tfontStyle={fontStyle}\n\t\t\t\tfontWeight={fontWeight}\n\t\t\t\tfontSize={fontSize}\n\t\t\t\ttext={text}\n\t\t\t/>\n\t\t\t<HoverTextNearMouse\n\t\t\t\tshow={hoverTextEnabled && hover && !selected}\n\t\t\t\t{...restHoverTextProps} />\n\t\t</g>;\n\t}\n}\n\nexport function getNewXY(moreProps, snapTo) {\n\tconst { xScale, xAccessor, plotData, mouseXY } = moreProps;\n\n\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\n\tconst x = xAccessor(currentItem);\n\tconst y = snapTo(currentItem);\n\n\treturn [x, y];\n}\n\nEachText.propTypes = {\n\tindex: PropTypes.number,\n\n\tposition: PropTypes.array.isRequired,\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\ttextFill: PropTypes.string.isRequired,\n\n\tfontWeight: PropTypes.string.isRequired,\n\tfontFamily: PropTypes.string.isRequired,\n\tfontStyle: PropTypes.string.isRequired,\n\tfontSize: PropTypes.number.isRequired,\n\n\ttext: PropTypes.string.isRequired,\n\tselected: PropTypes.bool.isRequired,\n\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n\n\thoverText: PropTypes.object.isRequired,\n};\n\nEachText.defaultProps = {\n\tonDrag: noop,\n\tonDragComplete: noop,\n\tedgeStroke: \"#000000\",\n\tedgeFill: \"#FFFFFF\",\n\tedgeStrokeWidth: 2,\n\tr: 5,\n\tstrokeWidth: 1,\n\topacity: 1,\n\tselected: false,\n\tfill: \"#8AAFE2\",\n\thoverText: {\n\t\t...HoverTextNearMouse.defaultProps,\n\t\tenable: true,\n\t\tbgHeight: 18,\n\t\tbgWidth: 120,\n\t\ttext: \"Click to select object\",\n\t}\n};\n\nexport default EachText;"]}