{"version":3,"sources":["../../../../../src/lib/interactive/components/MouseLocationIndicator.js"],"names":["React","Component","PropTypes","GenericChartComponent","getMouseCanvas","isDefined","getClosestValue","noop","shallowEqual","functor","MouseLocationIndicator","props","renderSVG","bind","drawOnCanvas","handleMousePosChange","handleMouseDown","handleClick","xy","mutableState","moreProps","e","pos","xValue","yValue","x","y","onMouseDown","onClick","xAccessor","mouseXY","currentItem","xScale","yScale","chartConfig","enabled","snap","shouldDisableSnap","snapTo","invert","mousXY","prevMouseXY","onMouseMove","ctx","r","stroke","strokeWidth","show","lineWidth","strokeStyle","moveTo","beginPath","arc","Math","PI","opacity","disablePan","handleContextMenu","propTypes","bool","isRequired","func","number","string","defaultProps"],"mappings":"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","file":"MouseLocationIndicator.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { getMouseCanvas } from \"../../GenericComponent\";\n\nimport { isDefined, getClosestValue, noop, shallowEqual, functor } from \"../../utils\";\n// import { getCurrentCharts } from \"../utils/ChartDataUtil\";\n\nclass MouseLocationIndicator extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\n\t\tthis.handleMousePosChange = this.handleMousePosChange.bind(this);\n\t\tthis.handleMouseDown = this.handleMouseDown.bind(this);\n\t\tthis.handleClick = this.handleClick.bind(this);\n\t\tthis.xy = this.xy.bind(this);\n\n\t\tthis.mutableState = {};\n\t}\n\thandleMouseDown(moreProps, e) {\n\t\tconst pos = this.xy(moreProps, e);\n\t\tif (isDefined(pos)) {\n\t\t\tconst { xValue, yValue, x, y } = pos;\n\t\t\tthis.mutableState = { x, y };\n\t\t\tthis.props.onMouseDown([xValue, yValue], moreProps, e);\n\t\t}\n\t}\n\thandleClick(moreProps, e) {\n\t\tconst pos = this.xy(moreProps, e);\n\t\tif (isDefined(pos)) {\n\t\t\tconst { xValue, yValue, x, y } = pos;\n\t\t\tthis.mutableState = { x, y };\n\t\t\tthis.props.onClick([xValue, yValue], moreProps, e);\n\t\t}\n\t}\n\txy(moreProps, e) {\n\t\tconst { xAccessor } = moreProps;\n\t\tconst { mouseXY, currentItem, xScale, chartConfig: { yScale } } = moreProps;\n\t\tconst { enabled, snap, shouldDisableSnap, snapTo } = this.props;\n\n\t\tif (enabled && isDefined(currentItem) && isDefined(e)) {\n\t\t\tconst xValue = xAccessor(currentItem);\n\t\t\tconst yValue = snap && !shouldDisableSnap(e)\n\t\t\t\t? getClosestValue(snapTo(currentItem), yScale.invert(mouseXY[1]))\n\t\t\t\t: yScale.invert(mouseXY[1]);\n\n\t\t\tconst x = xScale(xValue);\n\t\t\tconst y = yScale(yValue);\n\n\t\t\treturn { xValue, yValue, x, y };\n\t\t}\n\t}\n\thandleMousePosChange(moreProps, e) {\n\t\tif (!shallowEqual(moreProps.mousXY, moreProps.prevMouseXY)) {\n\t\t\tconst pos = this.xy(moreProps, e);\n\t\t\tif (isDefined(pos)) {\n\t\t\t\tconst { xValue, yValue, x, y } = pos;\n\t\t\t\tthis.mutableState = { x, y };\n\t\t\t\tthis.props.onMouseMove([xValue, yValue], e);\n\t\t\t}\n\t\t}\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst { enabled, r, stroke, strokeWidth } = this.props;\n\t\tconst { x, y } = this.mutableState;\n\t\tconst { show } = moreProps;\n\t\t// console.log(show)\n\t\tif (enabled && show && isDefined(x)) {\n\t\t\tctx.lineWidth = strokeWidth;\n\t\t\tctx.strokeStyle = stroke;\n\t\t\tctx.moveTo(x, y);\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(x, y, r, 0, 2 * Math.PI, false);\n\t\t\tctx.stroke();\n\t\t\t// ctx.fill();\n\t\t}\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { enabled, r, stroke, strokeWidth, opacity } = this.props;\n\t\tconst { x, y } = this.mutableState;\n\t\tconst { show } = moreProps;\n\n\t\t// console.log(\"HERE\")\n\t\t// console.log(stroke, strokeWidth, opacity)\n\n\t\treturn enabled && show && isDefined(x)\n\t\t\t? <circle\n\t\t\t\tcx={x}\n\t\t\t\tcy={y}\n\t\t\t\tr={r}\n\t\t\t\tstroke={stroke}\n\t\t\t\topacity={opacity}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstrokeWidth={strokeWidth} />\n\t\t\t: null;\n\n\t}\n\trender() {\n\t\tconst { enabled, disablePan } = this.props;\n\t\treturn <GenericChartComponent\n\t\t\tonMouseDown={this.handleMouseDown}\n\t\t\tonClick={this.handleClick}\n\t\t\tonContextMenu={this.handleContextMenu}\n\t\t\tonMouseMove={this.handleMousePosChange}\n\t\t\tonPan={this.handleMousePosChange}\n\n\t\t\tdisablePan={enabled && disablePan}\n\n\t\t\tsvgDraw={this.renderSVG}\n\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tcanvasToDraw={getMouseCanvas}\n\n\t\t\tdrawOn={[\"mousemove\", \"pan\"]}\n\t\t/>;\n\t}\n}\n\nMouseLocationIndicator.propTypes = {\n\tenabled: PropTypes.bool.isRequired,\n\tsnap: PropTypes.bool.isRequired,\n\tshouldDisableSnap: PropTypes.func.isRequired,\n\tsnapTo: PropTypes.func,\n\n\tonMouseMove: PropTypes.func.isRequired,\n\tonMouseDown: PropTypes.func.isRequired,\n\tonClick: PropTypes.func.isRequired,\n\tr: PropTypes.number.isRequired,\n\tstroke: PropTypes.string.isRequired,\n\tstrokeWidth: PropTypes.number.isRequired,\n\topacity: PropTypes.number.isRequired,\n\tdisablePan: PropTypes.bool.isRequired,\n};\n\nMouseLocationIndicator.defaultProps = {\n\tonMouseMove: noop,\n\tonMouseDown: noop,\n\tonClick: noop,\n\tshouldDisableSnap: functor(false),\n\tstroke: \"#000000\",\n\tstrokeWidth: 1,\n\topacity: 1,\n\tdisablePan: true,\n};\n\nexport default MouseLocationIndicator;"]}